<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mythical Adventure - MMORPG</title>
    
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <script src="https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexvirtualjoystickplugin.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Roboto:wght@400&display=swap');

        body { margin: 0; padding: 0; background-color: #050505; overflow: hidden; font-family: 'Roboto', sans-serif; }
        
        /* === PANTALLA DE LOGIN (NUEVO) === */
        #login-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(180deg, #1a0b00 0%, #000000 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 5000; /* Por encima de todo */
        }

        h1 { font-family: 'Cinzel', serif; color: #ffcc00; text-shadow: 0 0 10px #ff6600; font-size: 2.5rem; margin-bottom: 20px; text-align: center; }
        
        .input-group { margin-bottom: 20px; text-align: center; }
        input { 
            background: #222; border: 2px solid #555; color: white; padding: 10px; 
            font-size: 16px; border-radius: 5px; text-align: center; width: 200px;
        }

        .class-selector { display: flex; gap: 10px; margin-bottom: 30px; }
        .class-card {
            width: 70px; height: 90px; background: #2a2a2a; border: 2px solid #444;
            border-radius: 8px; cursor: pointer; display: flex; flex-direction: column;
            align-items: center; justify-content: center; transition: all 0.2s;
        }
        .class-card.selected { border-color: #ffcc00; background: #3a2a00; transform: scale(1.1); box-shadow: 0 0 15px #ffcc00aa; }
        .class-icon { font-size: 24px; margin-bottom: 5px; }
        .class-name { font-size: 10px; color: #aaa; text-transform: uppercase; }

        #start-btn {
            background: linear-gradient(90deg, #cc0000, #990000); color: white; border: none;
            padding: 15px 40px; font-size: 18px; font-weight: bold; border-radius: 30px;
            box-shadow: 0 0 20px rgba(204, 0, 0, 0.6); cursor: pointer; font-family: 'Cinzel', serif;
        }
        #start-btn:active { transform: scale(0.95); }

        /* === HUD DEL JUEGO (OCULTO AL INICIO) === */
        #game-ui { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 100; }
        #game-ui > * { pointer-events: auto; }

        /* PERFIL Y BARRAS */
        .player-status { position: absolute; top: 15px; left: 15px; display: flex; gap: 10px; }
        .avatar-frame {
            width: 55px; height: 55px; border-radius: 50%;
            border: 3px solid #ffd700; background: #222; overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.6);
        }
        .avatar-frame img { width: 100%; }
        .bars { display: flex; flex-direction: column; justify-content: center; gap: 5px; width: 140px; }
        
        .bar-bg { height: 10px; background: rgba(0,0,0,0.8); border-radius: 5px; border: 1px solid #444; overflow: hidden; position: relative; }
        .bar-text { position: absolute; width: 100%; text-align: center; font-size: 8px; color: white; top: -1px; text-shadow: 1px 1px 1px black; z-index: 2; }
        
        .hp-fill { height: 100%; width: 100%; background: linear-gradient(90deg, #d32f2f, #ff6659); transition: width 0.2s; }
        .mp-fill { height: 100%; width: 100%; background: linear-gradient(90deg, #1976d2, #63a4ff); transition: width 0.2s; }

        /* BOTONES DE ACCI√ìN */
        .action-bar { position: absolute; bottom: 20px; right: 20px; display: flex; gap: 8px; align-items: flex-end; }
        .btn {
            width: 50px; height: 50px; border-radius: 10px; border: 2px solid #555;
            background: rgba(20,20,20,0.9); color: white; font-size: 20px;
            backdrop-filter: blur(4px); box-shadow: 0 4px 6px rgba(0,0,0,0.4);
            display: flex; align-items: center; justify-content: center;
        }
        .btn:active { transform: scale(0.95); border-color: #ffd700; }
        .attack-btn { width: 70px; height: 70px; border-color: #d32f2f; font-size: 30px; background: rgba(50, 10, 10, 0.9); }
    </style>
</head>
<body>

    <div id="game-container"></div>

    <div id="login-screen">
        <h1>MYTHICAL<br>ADVENTURE</h1>
        
        <div class="input-group">
            <input type="text" id="username-input" placeholder="Nombre de tu H√©roe" maxlength="12">
        </div>

        <div class="class-selector">
            <div class="class-card selected" onclick="selectClass('knight', this)">
                <div class="class-icon">üõ°Ô∏è</div>
                <div class="class-name">Knight</div>
            </div>
            <div class="class-card" onclick="selectClass('mage', this)">
                <div class="class-icon">üî•</div>
                <div class="class-name">Mage</div>
            </div>
            <div class="class-card" onclick="selectClass('paladin', this)">
                <div class="class-icon">üèπ</div>
                <div class="class-name">Paladin</div>
            </div>
            <div class="class-card" onclick="selectClass('healer', this)">
                <div class="class-icon">‚ú®</div>
                <div class="class-name">Healer</div>
            </div>
        </div>

        <button id="start-btn" onclick="startGame()">CREAR PERSONAJE</button>
        <p style="color: #666; font-size: 10px; margin-top: 20px;">v1.0.5 - Heavy Duty Core</p>
    </div>

    <div id="game-ui">
        <div class="player-status">
            <div class="avatar-frame"><img src="client/assets/player.png" id="ui-avatar"></div>
            <div class="bars">
                <div class="bar-bg">
                    <div class="bar-text" id="hp-text">100/100</div>
                    <div class="hp-fill" id="hp-bar"></div>
                </div>
                <div class="bar-bg">
                    <div class="bar-text" id="mp-text">50/50</div>
                    <div class="mp-fill" id="mp-bar"></div>
                </div>
            </div>
        </div>

        <div class="action-bar">
            <button class="btn" onclick="emitAction('HEAL')">üíä</button>
            <button class="btn" onclick="emitAction('SPELL_1')">‚ö°</button>
            <button class="btn attack-btn" onclick="emitAction('ATTACK')">‚öîÔ∏è</button>
            <button class="btn" onclick="emitAction('DASH')">üí®</button>
        </div>
    </div>

    <script src="index.js"></script>
    
    <script>
        let selectedClass = 'knight';

        function selectClass(className, element) {
            selectedClass = className;
            // Visual selection
            document.querySelectorAll('.class-card').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
        }

        function startGame() {
            const name = document.getElementById('username-input').value;
            if(!name) { alert("¬°Debes ponerte un nombre, viajero!"); return; }

            // Ocultar Login, Mostrar Juego
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('game-ui').style.display = 'block';

            // Enviar datos al motor Phaser
            window.dispatchEvent(new CustomEvent('start-game', { 
                detail: { name: name, role: selectedClass } 
            }));
        }

        function emitAction(type) {
            window.dispatchEvent(new CustomEvent('game-action', { detail: type }));
        }
    </script>
</body>
</html>
