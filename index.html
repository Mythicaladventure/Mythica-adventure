<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mythica Apex: Total Legacy</title>
    <style>
        :root {
            --bg: #1c1c1c; --panel: #333; --border: #555;
            --gold: #ffd700; --gem: #ff00ff; --hp: #ff4444; 
            --mp: #4444ff; --cap: #99ff99; --pvt: #f0f;
        }
        * { box-sizing: border-box; font-family: 'Verdana', sans-serif; user-select: none; margin: 0; padding: 0; }
        body { background: #000; overflow: hidden; display: flex; color: #eee; height: 100vh; }

        /* --- PANTALLA DE LOGIN --- */
        #login-screen { position: fixed; inset: 0; background: radial-gradient(circle, #333 0%, #000 100%); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .login-box { background: rgba(0,0,0,0.8); padding: 30px; border: 2px solid var(--border); border-radius: 8px; width: 320px; text-align: center; }
        .login-input { width: 100%; padding: 12px; margin: 10px 0; background: #111; border: 1px solid var(--border); color: #fff; }
        .btn-gold { width: 100%; padding: 15px; background: var(--gold); border: none; font-weight: bold; cursor: pointer; color: #000; margin-top: 10px; }

        /* --- LAYOUT DEL JUEGO --- */
        #viewport { position: relative; flex: 1; background: #000; overflow: hidden; display: none; }
        #sidebar { width: 240px; background: var(--panel); border-left: 3px solid #111; display: none; flex-direction: column; z-index: 10; height: 100vh; }

        /* --- CONSOLA Y CHAT --- */
        #console { position: absolute; bottom: 0; left: 0; right: 0; height: 160px; background: rgba(0,0,0,0.95); border-top: 2px solid var(--border); display: flex; flex-direction: column; }
        .tabs { display: flex; background: #222; font-size: 10px; }
        .tab { padding: 8px 12px; cursor: pointer; border-right: 1px solid #444; }
        .tab.active { background: var(--panel); color: var(--gold); }
        #log { flex: 1; overflow-y: auto; padding: 8px; font-size: 11px; line-height: 1.4; color: #ccc; }
        #chat-in { background: #000; border: none; padding: 10px; color: #fff; border-top: 1px solid #333; }

        /* --- SIDEBAR COMPONENTS --- */
        .status-header { padding: 10px; background: #222; border-bottom: 2px solid #000; }
        .bar { height: 14px; background: #111; margin: 4px 0; position: relative; border: 1px solid #444; }
        .fill { height: 100%; transition: width 0.3s; }
        .bar-label { position: absolute; width: 100%; text-align: center; font-size: 9px; top: 0; font-weight: bold; color: #fff; text-shadow: 1px 1px #000; }

        .equip-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px; padding: 10px; background: #2a2a2a; }
        .slot { width: 44px; height: 44px; background: #444; border: 1px solid #666; font-size: 7px; display: flex; align-items: center; justify-content: center; color: #888; }

        #vip-list { flex: 1; overflow-y: auto; background: #1a1a1a; padding: 5px; font-size: 11px; border-top: 2px solid #000; }
        .vip-entry { display: flex; justify-content: space-between; padding: 2px 0; }

        /* --- MENU GENERAL --- */
        #main-menu { position: fixed; inset: 30px; background: var(--panel); border: 4px solid var(--border); z-index: 1000; display: none; }
        .menu-nav { width: 140px; background: #222; display: flex; flex-direction: column; }
        .nav-it { padding: 15px; border: none; background: transparent; color: #fff; cursor: pointer; text-align: left; font-size: 12px; border-bottom: 1px solid #333; }
        .nav-it.active { background: var(--panel); color: var(--gold); }
        .menu-content { flex: 1; padding: 25px; overflow-y: auto; }
    </style>
</head>
<body>

<div id="login-screen">
    <div class="login-box">
        <h2 style="color:var(--gold); margin-bottom:20px;">MYTHICA APEX</h2>
        <input type="text" id="acc-name" class="login-input" placeholder="Account Name">
        <input type="password" id="acc-pass" class="login-input" placeholder="Password">
        
        <div id="char-selection" style="display:none; margin: 15px 0; background:#222; padding:10px; border:1px solid var(--gold);">
            <p style="font-size:10px; color:var(--gold);">SELECT CHARACTER:</p>
            <div id="char-name-tag" style="padding:5px; background:#444; cursor:pointer; font-weight:bold; margin-top:5px;"></div>
        </div>

        <button id="btn-login" class="btn-gold" onclick="doLogin()">LOGIN</button>
        <button id="btn-enter" class="btn-gold" style="display:none; background:#282; color:#fff;" onclick="startGame()">ENTER GAME</button>
    </div>
</div>

<div id="viewport">
    <canvas id="stage"></canvas>
    <div id="console">
        <div class="tabs">
            <div class="tab active">Local Chat</div>
            <div class="tab">Server Log</div>
            <div class="tab" style="color:var(--gold)">Trade</div>
        </div>
        <div id="log"></div>
        <input type="text" id="chat-in" onkeypress="if(event.key==='Enter') sendMsg()">
    </div>
</div>

<div id="sidebar">
    <div class="status-header">
        <b id="ui-name" style="color:var(--gold); font-size:12px;">Player</b>
        <div class="bar"><div id="hp-f" class="fill" style="background:var(--hp);"></div><div class="bar-label" id="hp-t">100/100</div></div>
        <div class="bar"><div id="mp-f" class="fill" style="background:var(--mp);"></div><div class="bar-label" id="mp-t">50/50</div></div>
        <div style="font-size:10px; color:var(--cap); margin-top:5px;">Cap: <span id="cap-v">400.0</span> oz</div>
    </div>

    <div class="equip-grid">
        <div class="slot"></div><div class="slot">HEAD</div><div class="slot"></div>
        <div class="slot">L-H</div><div class="slot">BODY</div><div class="slot">R-H</div>
        <div class="slot">BAG</div><div class="slot">LEGS</div><div class="slot"></div>
        <div class="slot"></div><div class="slot">FEET</div><div class="slot"></div>
    </div>

    <div id="vip-list">
        <div style="font-size:9px; color:var(--gold); border-bottom:1px solid #333; margin-bottom:5px;">VIP LIST <span onclick="addFriend()" style="float:right; cursor:pointer; color:#9f9;">[+]</span></div>
        <div id="vip-box"></div>
    </div>

    <button onclick="toggleMenu()" style="width:100%; padding:10px; background:#222; color:#fff; border:none; border-top:2px solid #000; cursor:pointer; font-weight:bold;">MENU GENERAL</button>
</div>

<div id="main-menu">
    <div class="menu-nav">
        <button class="nav-it active" onclick="setMenuTab('skills')">SKILLS</button>
        <button class="nav-it" onclick="setMenuTab('store')">STORE üíé</button>
        <button class="nav-it" onclick="setMenuTab('quests')">QUESTS</button>
        <button class="nav-it" style="margin-top:auto; background:#522;" onclick="toggleMenu()">CERRAR</button>
    </div>
    <div class="menu-content" id="m-content"></div>
</div>

<script>
    const canvas = document.getElementById('stage');
    const ctx = canvas.getContext('2d');

    // DATA CORE
    let p = {
        name: "H√©roe", level: 1, x: 2500, y: 2500, hp: 100, mHp: 100, mp: 50, mMp: 50,
        cap: 400.0, wallet: { gold: 0, gem: 5 }, skills: { sword: 10, shield: 10, magic: 1 },
        adProgress: 0, vip: [{name: "SocioAI", on: true}]
    };

    // LOGIN LOGIC
    function doLogin() {
        const acc = document.getElementById('acc-name').value;
        if(!acc) return alert("Ingrese cuenta");
        document.getElementById('acc-name').style.display = 'none';
        document.getElementById('acc-pass').style.display = 'none';
        document.getElementById('btn-login').style.display = 'none';
        document.getElementById('char-selection').style.display = 'block';
        document.getElementById('btn-enter').style.display = 'block';
        document.getElementById('char-name-tag').innerText = p.name + " (Lv. 1)";
    }

    function startGame() {
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('viewport').style.display = 'block';
        document.getElementById('sidebar').style.display = 'flex';
        resize();
        addLog("Welcome to Mythica Apex. Server online.", "#9f9");
        loop();
    }

    // GAME ENGINE
    function loop() {
        update();
        draw();
        requestAnimationFrame(loop);
    }

    function update() {
        updateUI();
        updateVIP();
    }

    function draw() {
        ctx.fillStyle = "#000"; ctx.fillRect(0,0,canvas.width, canvas.height);
        ctx.save();
        ctx.translate(canvas.width/2 - p.x, canvas.height/2 - p.y);
        // Grid
        ctx.strokeStyle = "#222";
        for(let i=2300; i<2700; i+=32) {
            ctx.beginPath(); ctx.moveTo(i, 2300); ctx.lineTo(i, 2700); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(2300, i); ctx.lineTo(2700, i); ctx.stroke();
        }
        // Player
        ctx.fillStyle = "#fff"; ctx.fillRect(p.x-16, p.y-16, 32, 32);
        ctx.restore();
    }

    // UI & SOCIAL
    function updateUI() {
        document.getElementById('hp-f').style.width = (p.hp/p.mHp*100) + "%";
        document.getElementById('hp-t').innerText = `${p.hp}/${p.mHp}`;
        document.getElementById('cap-v').innerText = p.cap.toFixed(1);
        document.getElementById('ui-name').innerText = p.name;
    }

    function addLog(m, c = "#ccc") {
        const l = document.getElementById('log');
        l.innerHTML += `<div style="color:${c}">${m}</div>`;
        l.scrollTop = l.scrollHeight;
    }

    function sendMsg() {
        const i = document.getElementById('chat-in');
        if(i.value) { addLog(p.name + ": " + i.value); i.value = ""; }
    }

    function updateVIP() {
        const box = document.getElementById('vip-box');
        box.innerHTML = p.vip.map(v => `<div class="vip-entry"><span>${v.name}</span><span style="color:${v.on?'#5f5':'#f55'}">${v.on?'‚óè':'‚óã'}</span></div>`).join('');
    }

    function addFriend() {
        const n = prompt("Nombre:");
        if(n) { p.vip.push({name: n, on: false}); addLog("A√±adido a VIP: " + n); }
    }

    // MENU & STORE (10:1 REGLA)
    function toggleMenu() {
        const m = document.getElementById('main-menu');
        m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
        if(m.style.display === 'flex') setMenuTab('skills');
    }

    function setMenuTab(t) {
        const c = document.getElementById('m-content');
        if(t === 'skills') {
            c.innerHTML = `<h2>Skills</h2><p>Sword: ${p.skills.sword}</p><p>Shield: ${p.skills.shield}</p>`;
        } else if(t === 'store') {
            c.innerHTML = `<h2>Store</h2><p>Gemas: ${p.wallet.gem} üíé</p>
            <div style="background:#222; padding:15px; border:1px solid var(--gold); margin-top:10px;">
                <b>Video Recompensa</b><br>Progreso: ${p.adProgress}/10
                <button onclick="watchVideo()" style="display:block; margin-top:10px; padding:10px; background:var(--gold); border:none;">VER VIDEO</button>
            </div>`;
        }
    }

    function watchVideo() {
        addLog("Viendo video... (15s)");
        setTimeout(() => {
            p.adProgress++;
            if(p.adProgress >= 10) { p.wallet.gem++; p.adProgress = 0; addLog("¬°Ganaste 1 Gema! üíé", "var(--gold)"); }
            setMenuTab('store');
        }, 1500);
    }

    function resize() {
        canvas.width = document.getElementById('viewport').clientWidth;
        canvas.height = document.getElementById('viewport').clientHeight;
    }

    window.onresize = resize;
</script>
</body>
</html>
