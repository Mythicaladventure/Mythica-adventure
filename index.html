<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mythical Client</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* LAYOUT GLOBAL - ESTILO CLIENTE DE ESCRITORIO */
        * { box-sizing: border-box; touch-action: none; user-select: none; }
        body { 
            margin: 0; padding: 0; background: #2b2b2b; color: #d4d4d4; 
            font-family: 'Roboto', sans-serif; overflow: hidden;
            display: flex; flex-direction: column; height: 100vh;
        }

        /* HEADER */
        header { height: 40px; background: #1a1a1a; border-bottom: 2px solid #444; display: flex; align-items: center; justify-content: center; }
        .title { color: #d4af37; font-family: 'Cinzel'; letter-spacing: 2px; }

        /* MAIN CONTENT ROW */
        .main-row { display: flex; flex: 1; overflow: hidden; }

        /* GAME WINDOW (IZQUIERDA/CENTRO) */
        #game-view { 
            flex: 1; position: relative; background: #000; 
            border: 2px solid #555; margin: 5px; box-shadow: inset 0 0 20px #000;
        }

        /* SIDEBAR (DERECHA) */
        .sidebar { 
            width: 180px; background: #383838; border-left: 2px solid #222; 
            padding: 5px; display: flex; flex-direction: column; gap: 5px;
        }
        .panel { background: #4a4a4a; border: 1px solid #222; border-radius: 3px; padding: 5px; }
        .minimap { height: 120px; background: #000; border: 1px solid #666; display: flex; align-items: center; justify-content: center; color: #555; font-size: 10px; }
        .inventory { height: 150px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 2px; }
        .slot { background: #222; border: 1px inset #555; height: 40px; }

        /* BOTTOM CONSOLE (ABAJO) */
        .console { 
            height: 120px; background: #222; border-top: 2px solid #444; 
            padding: 5px; display: flex; flex-direction: column; 
        }
        #chat-log { flex: 1; overflow-y: auto; font-size: 11px; font-family: monospace; color: #fff; }
        .chat-input { display: flex; border-top: 1px solid #444; }
        .chat-input input { flex: 1; background: #111; border: none; color: #fff; padding: 5px; }
        .chat-input button { width: 40px; background: #333; color: gold; border: 1px solid #555; }

        /* LOGIN OVERLAY */
        #login-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999;
            background: rgba(0,0,0,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .login-box { 
            background: #2a2a2a; border: 2px solid #d4af37; padding: 30px; border-radius: 8px; width: 300px; text-align: center; 
        }
        .login-box input { width: 100%; padding: 10px; margin: 10px 0; background: #111; color: #fff; border: 1px solid #555; text-align: center; }
        .login-box button { width: 100%; padding: 10px; background: #8a0b0b; color: #fff; font-weight: bold; border: none; cursor: pointer; }

        /* BUTTONS FLOATING (MOBILE CONTROLS) */
        .mobile-actions { position: absolute; bottom: 20px; right: 20px; display: flex; gap: 10px; z-index: 50; }
        .mob-btn { width: 50px; height: 50px; border-radius: 50%; background: rgba(0,0,0,0.5); border: 2px solid #fff; color: #fff; font-size: 20px; }
        .mob-atk { background: rgba(200, 0, 0, 0.5); border-color: red; width: 60px; height: 60px; }

        /* RESPONSIVE: En móvil ocultar sidebar o hacerla flotante */
        @media (max-width: 600px) {
            .sidebar { display: none; } /* Ocultar sidebar en móvil para más espacio */
            .console { height: 80px; }
        }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div class="login-box">
            <h2 style="color:#d4af37; font-family:'Cinzel'">MYTHICAL</h2>
            <input type="text" id="char-name" placeholder="Nombre" maxlength="10">
            <button onclick="enterGame()">ENTRAR</button>
        </div>
    </div>

    <header><div class="title">MYTHICAL ADVENTURE</div></header>
    
    <div class="main-row">
        <div id="game-view">
            <div class="mobile-actions">
                <button class="mob-btn" onclick="act('HEAL')">H</button>
                <button class="mob-btn mob-atk" onclick="act('ATTACK')">⚔️</button>
            </div>
        </div>

        <div class="sidebar">
            <div class="panel minimap">MINIMAP</div>
            <div class="panel">
                <div style="font-size:10px; text-align:center; margin-bottom:2px; color:gold;">EQUIPO</div>
                <div class="inventory">
                    <div class="slot"></div><div class="slot"></div>
                    <div class="slot"></div><div class="slot"></div>
                </div>
            </div>
            <div class="panel" style="flex:1;">
                <div style="font-size:10px; color:#aaa;">BATTLE LIST</div>
            </div>
        </div>
    </div>

    <div class="console">
        <div id="chat-log"><div>Bienvenido al servidor de prueba.</div></div>
        <div class="chat-input">
            <input type="text" id="chat-in" placeholder="Say...">
            <button onclick="chat()">Send</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/colyseus.js@0.15.0/dist/colyseus.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/phaser3-rex-plugins@1.1.84/dist/rexvirtualjoystickplugin.min.js"></script>
    
    <script src="client/index.js?v=FINAL_PROTOTYPE"></script>

    <script>
        function enterGame() {
            const name = document.getElementById('char-name').value;
            if(name) window.dispatchEvent(new CustomEvent('start-game', { detail: { name, role:'knight' } }));
        }
        function act(t) { window.dispatchEvent(new CustomEvent('game-action', { detail: t })); }
        function chat() {
            const i = document.getElementById('chat-in');
            if(i.value) {
                document.getElementById('chat-log').innerHTML += `<div>You: ${i.value}</div>`;
                i.value='';
            }
        }
    </script>
</body>
</html>
